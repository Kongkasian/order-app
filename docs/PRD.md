# 커피 주문 앱 

## 1. 프로젝트 개요

### 1.1 프로젝트명 
커피 주문 앱 

### 1.2 프로젝트 목적 
사용자가 커피 메뉴를 주문하고, 관리자가 주문을 관리할 수 있는 간단한 풀스택 웹 앱

### 1.3 개발 범위  
- 주문하기 화면 (메뉴 선택 및 장바구니 가능) 
- 관리자 화면 (재고 관리 및 주문 상태 관리) 
- 데이터를 생성/조회/수정/삭제할 수 있는 기능

## 2. 기술 스텍 
- 프런트엔드: HTML, CSS, 리액트, 자바스크립트 
- 백엔드: Node.js, Express 
- 데이터베이스: PostgreSQL

## 3. 기본 사항 
- 프런트엔드와 백엔드를 따로 개발 
- 기본적인 웹 기술만 사용 
- 학습 목적이므로 사용자 인증이나 결제 기능은 제외 
- 메뉴는 커피 메뉴만 있음 

## 4. 화면별 상세 요구사항

### 4.1 주문하기 화면

#### 4.1.1 레이아웃 구조
화면은 크게 세 부분으로 구성됩니다:
1. **헤더 영역** (상단 고정)
2. **메뉴 아이템 영역** (중앙 스크롤 가능)
3. **장바구니 영역** (하단 고정)

#### 4.1.2 헤더 영역
- **브랜드명**: 좌측 상단에 "COZY" 텍스트 표시
  - 배경색: 다크 그린 (#2d5016 또는 유사 색상)
  - 텍스트 색상: 흰색
  - 패딩: 적절한 여백
- **내비게이션 버튼**: 우측에 두 개의 버튼
  - "주문하기" 버튼 (현재 페이지)
  - "관리자" 버튼 (관리자 화면으로 이동)

#### 4.1.3 메뉴 아이템 영역
각 메뉴 아이템은 카드 형태로 표시되며, 가로로 여러 개 배치됩니다.

**메뉴 카드 구성 요소:**
1. **메뉴 이미지**
   - 상단에 이미지 영역 (플레이스홀더 이미지 지원)
   - 이미지가 없을 경우 빈 영역 또는 기본 플레이스홀더 표시
2. **메뉴명**
   - 예: "아메리카노(ICE)", "아메리카노(HOT)", "카페라떼"
3. **가격**
   - 한국 원화 형식으로 표시 (예: "4,000원", "5,000원")
4. **설명**
   - 간단한 메뉴 설명 텍스트 (예: "간단한 설명...")
5. **옵션 선택**
   - 체크박스 형태의 옵션들
   - 각 옵션은 옵션명과 추가 가격을 표시
   - 예: "샷 추가 (+500원)", "시럽 추가 (+0원)"
   - 사용자가 여러 옵션을 동시에 선택 가능
6. **담기 버튼**
   - 카드 하단에 "담기" 버튼
   - 클릭 시 선택한 옵션과 함께 장바구니에 추가

**레이아웃:**
- 메뉴 카드들은 반응형 그리드 형태로 배치 (가로 3개 이상)
- 카드 간 적절한 간격 유지
- 카드 내부 요소들은 세로로 정렬

#### 4.1.4 장바구니 영역
하단에 고정된 장바구니 섹션이 표시됩니다.

**장바구니 구성 요소:**
1. **제목**: "장바구니" 텍스트
2. **아이템 목록**
   - 각 아이템은 다음 정보를 표시:
     - 메뉴명 (선택한 옵션이 있으면 옵션명 포함)
     - 수량 (예: "X 1", "X 2")
     - 가격 (해당 아이템의 총 가격)
   - 예시:
     - "아메리카노(ICE) (샷 추가) X 1 - 4,500원"
     - "아메리카노(HOT) X 2 - 8,000원"
3. **총 금액**
   - "총 금액" 라벨과 함께 총 합계 금액을 굵게 표시
   - 예: "총 금액 12,500원"
4. **주문하기 버튼**
   - 장바구니 하단에 "주문하기" 버튼
   - 클릭 시 주문을 완료하는 기능

**상태 관리:**
- 장바구니에 아이템이 없을 경우 적절한 메시지 표시
- 아이템 추가/삭제 시 실시간으로 총 금액 업데이트
- 같은 메뉴와 옵션 조합이 추가되면 수량 증가

#### 4.1.5 기능 요구사항
- 메뉴 목록은 서버에서 동적으로 가져옴
- 옵션 선택은 각 메뉴 카드에서 독립적으로 동작
- "담기" 버튼 클릭 시 선택된 옵션 정보가 포함되어 장바구니에 추가
- 장바구니 아이템 수량 증가/감소 기능 (추가 구현 필요)
- 장바구니 아이템 삭제 기능 (추가 구현 필요)
- "주문하기" 버튼 클릭 시 주문 완료 처리 및 장바구니 초기화

#### 4.1.6 UI/UX 가이드라인
- 깔끔하고 미니멀한 디자인
- 흰색 배경에 어두운 회색 텍스트
- 다크 그린 색상은 브랜드명에만 사용
- 버튼은 회색 계열로 표시
- 충분한 여백과 간격으로 가독성 확보

### 4.2 관리자 화면

#### 4.2.1 레이아웃 구조
화면은 크게 네 부분으로 구성됩니다:
1. **헤더 영역** (상단 고정)
2. **관리자 대시보드 요약 섹션** (상단)
3. **재고 현황 섹션** (중앙)
4. **주문 현황 섹션** (하단)

#### 4.2.2 헤더 영역
- **브랜드명**: 좌측 상단에 "COZY" 텍스트 표시
  - 배경색: 다크 그린 (#2d5016 또는 유사 색상)
  - 텍스트 색상: 흰색
  - 패딩: 적절한 여백
- **내비게이션 버튼**: 우측에 두 개의 버튼
  - "주문하기" 버튼 (주문하기 화면으로 이동)
  - "관리자" 버튼 (현재 페이지, 선택된 상태로 표시)

#### 4.2.3 관리자 대시보드 요약 섹션
현재 주문 상태를 요약하여 보여주는 대시보드입니다.

**구성 요소:**
- **제목**: "관리자 대시보드"
- **주문 상태 요약**:
  - 총 주문: 전체 주문 건수
  - 주문 접수: 접수된 주문 건수
  - 제조 중: 현재 제조 중인 주문 건수
  - 제조 완료: 제조 완료된 주문 건수
- 각 상태는 숫자와 함께 표시 (예: "총 주문 1", "주문 접수 1", "제조 중 0", "제조 완료 0")

**레이아웃:**
- 상태별로 카드 형태 또는 리스트 형태로 표시
- 가로로 나열하거나 그리드 형태로 배치

#### 4.2.4 재고 현황 섹션
각 메뉴 아이템의 현재 재고 상태를 보여주고, 재고를 조절할 수 있는 기능을 제공합니다.

**구성 요소:**
- **제목**: "재고 현황"
- **메뉴 아이템별 재고 정보**:
  - 메뉴명 (예: "아메리카노 (ICE)", "아메리카노 (HOT)", "카페라떼")
  - 현재 재고: 숫자와 "개" 단위로 표시 (예: "10개")
  - 재고 수량 조절 버튼:
    - "+" 버튼: 재고 증가
    - "-" 버튼: 재고 감소
    - 버튼은 재고 수량 아래에 배치

**레이아웃:**
- 각 메뉴 아이템은 카드 형태 또는 리스트 항목으로 표시
- 메뉴명, 재고 수량, 조절 버튼이 함께 표시
- 세로로 리스트 형태로 나열

**기능:**
- "+" 버튼 클릭 시 해당 메뉴의 재고 1개 증가
- "-" 버튼 클릭 시 해당 메뉴의 재고 1개 감소 (최소 0개까지)
- 재고 변경 시 서버에 실시간 업데이트

#### 4.2.5 주문 현황 섹션
현재 들어온 주문 목록을 보여주고, 각 주문에 대한 상태 변경 및 처리를 할 수 있습니다.

**구성 요소:**
- **제목**: "주문 현황"
- **주문 목록**: 각 주문은 다음 정보를 포함
  - 주문 시간: 날짜와 시간 표시 (예: "7월 31일 13:00")
  - 주문 내역: 주문한 메뉴와 수량 (예: "아메리카노(ICE) x 1")
  - 가격: 해당 주문의 총 금액 (예: "4,000원")
  - 액션 버튼: 주문 상태에 따라 다른 버튼 표시
    - "주문 접수" 버튼: 주문을 접수하고 제조 시작
    - "제조 완료" 버튼: 제조를 완료 처리 (추가 구현 필요)

**레이아웃:**
- 주문 목록은 세로로 나열
- 각 주문은 카드 형태 또는 리스트 항목으로 표시
- 주문 정보와 액션 버튼이 함께 표시

**상태 관리:**
- 주문이 없을 경우 적절한 메시지 표시
- 주문 상태에 따라 다른 액션 버튼 표시
- 주문 처리 시 대시보드 요약 정보도 함께 업데이트

#### 4.2.6 기능 요구사항
- 관리자 대시보드 요약 정보는 서버에서 동적으로 가져와 실시간 업데이트
- 재고 현황은 서버에서 현재 재고 정보를 가져와 표시
- 재고 수량 조절 시 서버에 즉시 반영
- 주문 현황 목록은 서버에서 주문 정보를 가져와 표시
- "주문 접수" 버튼 클릭 시 해당 주문의 상태를 "제조 중"으로 변경
- 주문 상태 변경 시 대시보드 요약 정보도 함께 업데이트
- 주문 완료 처리 기능 (추가 구현 필요)
- 주문 목록은 최신 주문이 위에 표시되도록 정렬

#### 4.2.7 UI/UX 가이드라인
- 깔끔하고 기능적인 레이아웃
- 흰색 배경에 어두운 회색 텍스트
- 다크 그린 색상은 브랜드명에만 사용
- 버튼은 회색 계열로 표시
- 섹션별로 명확한 구분
- 각 섹션에 적절한 제목 표시
- 충분한 여백과 간격으로 가독성 확보
- 재고 조절 버튼과 액션 버튼은 명확하게 표시

## 5. 백엔드 개발 요구사항

### 5.1 데이터 모델

#### 5.1.1 Menus (메뉴)
커피 메뉴 정보를 저장하는 테이블입니다.

**필드:**
- `id` (INTEGER, PRIMARY KEY, AUTO_INCREMENT): 메뉴 고유 ID
- `name` (VARCHAR): 커피 이름 (예: "아메리카노(ICE)", "카페라떼")
- `description` (TEXT): 메뉴 설명
- `price` (INTEGER): 메뉴 기본 가격 (원 단위)
- `image` (VARCHAR): 이미지 URL 또는 경로
- `stock` (INTEGER): 재고 수량 (기본값: 0)

**제약 조건:**
- `name`, `price`는 필수 (NOT NULL)
- `price`는 0 이상의 정수
- `stock`은 0 이상의 정수

#### 5.1.2 Options (옵션)
메뉴 옵션 정보를 저장하는 테이블입니다.

**필드:**
- `id` (INTEGER, PRIMARY KEY, AUTO_INCREMENT): 옵션 고유 ID
- `name` (VARCHAR): 옵션 이름 (예: "샷 추가", "시럽 추가")
- `price` (INTEGER): 옵션 추가 가격 (원 단위, 0 이상)
- `menu_id` (INTEGER, FOREIGN KEY): 연결된 메뉴 ID (Menus 테이블 참조)

**제약 조건:**
- `name`, `price`, `menu_id`는 필수 (NOT NULL)
- `price`는 0 이상의 정수
- `menu_id`는 Menus 테이블의 id와 외래키 관계

#### 5.1.3 Orders (주문)
주문 정보를 저장하는 테이블입니다.

**필드:**
- `id` (INTEGER, PRIMARY KEY, AUTO_INCREMENT): 주문 고유 ID
- `order_date` (TIMESTAMP): 주문 일시 (기본값: 현재 시간)
- `status` (VARCHAR): 주문 상태 (기본값: 'received')
  - 'received': 주문 접수
  - 'manufacturing': 제조 중
  - 'completed': 제조 완료
- `total_amount` (INTEGER): 주문 총 금액 (원 단위)
- `items` (JSON 또는 TEXT): 주문 내용 (메뉴, 수량, 옵션, 금액)
  - JSON 형식 예시:
    ```json
    [
      {
        "menuId": 1,
        "menuName": "아메리카노(ICE)",
        "quantity": 1,
        "options": ["샷 추가"],
        "price": 4000,
        "optionPrice": 500,
        "totalPrice": 4500
      }
    ]
    ```

**제약 조건:**
- `order_date`, `status`, `total_amount`, `items`는 필수 (NOT NULL)
- `total_amount`는 0 이상의 정수
- `status`는 'received', 'manufacturing', 'completed' 중 하나

### 5.2 데이터 스키마를 위한 사용자 흐름

#### 5.2.1 메뉴 조회 흐름
① **Menus 테이블 조회**
- 주문하기 화면 진입 시 Menus 테이블에서 모든 메뉴 정보를 조회
- 메뉴 정보: id, name, description, price, image
- 재고 수량(stock)은 관리자 화면에서만 조회 및 표시

② **옵션 정보 조회**
- 각 메뉴에 연결된 Options 테이블의 옵션 정보를 함께 조회
- 옵션 정보: id, name, price

③ **프런트엔드 표시**
- 조회한 메뉴 정보를 브라우저 화면에 카드 형태로 표시
- 각 메뉴 카드에 옵션 선택 체크박스 표시

#### 5.2.2 주문 생성 흐름
① **장바구니 정보 수집**
- 사용자가 선택한 메뉴, 수량, 옵션 정보를 프런트엔드에서 수집

② **주문 정보 생성**
- 주문 시간: 현재 시간 (TIMESTAMP)
- 주문 상태: 'received' (주문 접수)
- 주문 내용(items): 메뉴 ID, 메뉴명, 수량, 선택한 옵션, 가격 정보를 JSON 형식으로 저장
- 총 금액(total_amount): 모든 주문 항목의 총합 계산

③ **Orders 테이블에 저장**
- 생성한 주문 정보를 Orders 테이블에 INSERT

④ **재고 차감 (선택사항)**
- 주문이 완료되면 해당 메뉴의 재고(stock)를 주문 수량만큼 차감
- 재고가 부족한 경우 에러 처리 필요

#### 5.2.3 관리자 주문 관리 흐름
① **주문 목록 조회**
- Orders 테이블에서 모든 주문 정보를 조회
- 주문 상태별로 필터링 가능
- 최신 주문순으로 정렬 (order_date DESC)

② **주문 상태 변경**
- 관리자가 '제조 시작' 버튼 클릭 시
  - 해당 주문의 status를 'received' → 'manufacturing'으로 UPDATE
- 관리자가 '제조 완료' 버튼 클릭 시
  - 해당 주문의 status를 'manufacturing' → 'completed'로 UPDATE

③ **대시보드 통계 조회**
- Orders 테이블에서 상태별 주문 개수 집계
  - 총 주문: 전체 주문 개수
  - 주문 접수: status = 'received' 개수
  - 제조 중: status = 'manufacturing' 개수
  - 제조 완료: status = 'completed' 개수

#### 5.2.4 재고 관리 흐름
① **재고 조회**
- Menus 테이블에서 재고 수량(stock) 조회
- 관리자 화면의 '재고 현황' 섹션에 표시

② **재고 수정**
- 관리자가 +/- 버튼으로 재고 수량 조절
- Menus 테이블의 해당 메뉴의 stock 값을 UPDATE

### 5.3 API 설계

#### 5.3.1 메뉴 관련 API

**GET /api/menus**
- **설명**: 모든 커피 메뉴 목록 조회
- **요청**: 없음
- **응답**: 
  ```json
  {
    "success": true,
    "data": [
      {
        "id": 1,
        "name": "아메리카노(ICE)",
        "description": "간단한 설명...",
        "price": 4000,
        "image": "https://...",
        "options": [
          {
            "id": 1,
            "name": "샷 추가",
            "price": 500
          },
          {
            "id": 2,
            "name": "시럽 추가",
            "price": 0
          }
        ]
      }
    ]
  }
  ```
- **에러 응답**:
  ```json
  {
    "success": false,
    "error": "메뉴 목록을 불러올 수 없습니다."
  }
  ```

**GET /api/menus/:id/stock**
- **설명**: 특정 메뉴의 재고 수량 조회 (관리자용)
- **요청 파라미터**: `id` (메뉴 ID)
- **응답**:
  ```json
  {
    "success": true,
    "data": {
      "menuId": 1,
      "stock": 10
    }
  }
  ```

**PUT /api/menus/:id/stock**
- **설명**: 특정 메뉴의 재고 수량 수정 (관리자용)
- **요청 파라미터**: `id` (메뉴 ID)
- **요청 body**:
  ```json
  {
    "stock": 15
  }
  ```
- **응답**:
  ```json
  {
    "success": true,
    "data": {
      "menuId": 1,
      "stock": 15
    }
  }
  ```

#### 5.3.2 주문 관련 API

**POST /api/orders**
- **설명**: 새로운 주문 생성
- **요청 body**:
  ```json
  {
    "items": [
      {
        "menuId": 1,
        "menuName": "아메리카노(ICE)",
        "quantity": 1,
        "options": ["샷 추가"],
        "price": 4000,
        "optionPrice": 500,
        "totalPrice": 4500
      }
    ],
    "totalAmount": 4500
  }
  ```
- **응답**:
  ```json
  {
    "success": true,
    "data": {
      "orderId": 1,
      "orderDate": "2024-01-15T10:30:00Z",
      "status": "received",
      "totalAmount": 4500
    }
  }
  ```
- **에러 응답**:
  ```json
  {
    "success": false,
    "error": "주문 처리 중 오류가 발생했습니다."
  }
  ```
- **참고**: 주문 생성 시 해당 메뉴의 재고도 함께 차감 처리

**GET /api/orders**
- **설명**: 모든 주문 목록 조회 (관리자용)
- **쿼리 파라미터** (선택사항):
  - `status`: 주문 상태로 필터링 ('received', 'manufacturing', 'completed')
- **응답**:
  ```json
  {
    "success": true,
    "data": [
      {
        "id": 1,
        "orderDate": "2024-01-15T10:30:00Z",
        "status": "received",
        "items": [...],
        "totalAmount": 4500
      }
    ]
  }
  ```
- **정렬**: orderDate 기준 내림차순 (최신순)

**GET /api/orders/:id**
- **설명**: 특정 주문 정보 조회
- **요청 파라미터**: `id` (주문 ID)
- **응답**:
  ```json
  {
    "success": true,
    "data": {
      "id": 1,
      "orderDate": "2024-01-15T10:30:00Z",
      "status": "received",
      "items": [...],
      "totalAmount": 4500
    }
  }
  ```
- **에러 응답**:
  ```json
  {
    "success": false,
    "error": "주문을 찾을 수 없습니다."
  }
  ```

**PATCH /api/orders/:id/status**
- **설명**: 주문 상태 변경 (관리자용)
- **요청 파라미터**: `id` (주문 ID)
- **요청 body**:
  ```json
  {
    "status": "manufacturing"
  }
  ```
- **응답**:
  ```json
  {
    "success": true,
    "data": {
      "id": 1,
      "status": "manufacturing"
    }
  }
  ```
- **상태 변경 규칙**:
  - 'received' → 'manufacturing' (제조 시작)
  - 'manufacturing' → 'completed' (제조 완료)

#### 5.3.3 대시보드 관련 API

**GET /api/dashboard/stats**
- **설명**: 관리자 대시보드 통계 정보 조회
- **요청**: 없음
- **응답**:
  ```json
  {
    "success": true,
    "data": {
      "total": 10,
      "received": 3,
      "manufacturing": 5,
      "completed": 2
    }
  }
  ```

#### 5.3.4 API 공통 사항

**응답 형식:**
- 모든 API는 JSON 형식으로 응답
- 성공 시: `{ "success": true, "data": ... }`
- 실패 시: `{ "success": false, "error": "에러 메시지" }`

**HTTP 상태 코드:**
- 200: 성공
- 400: 잘못된 요청 (Bad Request)
- 404: 리소스를 찾을 수 없음 (Not Found)
- 500: 서버 내부 오류 (Internal Server Error)

**CORS 설정:**
- 프런트엔드와 백엔드가 분리되어 있으므로 CORS 설정 필요
- 개발 환경에서는 모든 origin 허용 가능

**에러 처리:**
- 데이터베이스 연결 오류
- 잘못된 데이터 형식
- 존재하지 않는 리소스 접근
- 재고 부족 등의 비즈니스 로직 오류